---
title: "Tarea 1"
output:
  html_document:
    df_print: paged
---

![](banner.png)

<center>

<h1>Tarea 1: Foundations</h1>

</center>

<center><strong>CC6104: Statistical Thinking</strong></center>

#### **Integrantes :**

-   Tamara Marciel
-   Vicente Pinochet

#### **Cuerpo Docente:**

-   Profesor: Felipe Bravo M.
-   Auxiliares: Benjam√≠n Far√≠as, Mart√≠n Paredes
-   Ayudantes: Scarleth Betancurt, Emilio D√≠az, Kevin Iturra, Renzo Zanca

### **√çndice:**

1.  [Objetivo](#id1)
2.  [Instrucciones](#id2)
3.  [Referencias](#id3)
4.  [Elaboraci√≥n de C√≥digo](#id4)

### **Objetivo**<a name="id1"></a>

[Bienvenid\@s](mailto:Bienvenid@s){.email} a la primera tarea del curso Statistical Thinking. Esta tarea tiene como objetivo evaluar los contenidos te√≥ricos de la primera parte del curso, los cuales se enfocan principalmente en an√°lisis exploratorio de datos y conceptos introductorios de probabilidades. Si a√∫n no han visto las clases, se recomienda visitar los enlaces de las referencias.

La tarea consta de ejercicios pr√°cticos con el f√≠n de introducirlos a la programaci√≥n en R enfocada en el an√°lisis estad√≠stico de datos.

### **Instrucciones:**<a name="id2"></a>

-   La tarea se realiza en grupos de **m√°ximo 2 personas**. Pero no existe problema si usted desea hacerla de forma individual.
-   La entrega es a trav√©s de u-cursos a m√°s tardar el d√≠a estipulado en la misma plataforma. A las tareas atrasadas se les descontar√° un punto por d√≠a.
-   El formato de entrega es este mismo **Rmarkdown** y un **html** con la tarea desarrollada. Por favor compruebe que todas las celdas han sido ejecutadas en el archivo html.
-   Al momento de la revisi√≥n tu c√≥digo ser√° ejecutado. Por favor verifica que tu entrega no tenga errores de compilaci√≥n.
-   No ser√°n revisadas tareas desarrolladas en Python.
-   Est√° **PROHIBIDO** la copia o compartir las respuestas entre integrantes de diferentes grupos.
-   Pueden realizar consultas de la tarea a trav√©s de U-cursos y/o del canal de Discord del curso.

### **Referencias:**<a name="id3"></a>

Slides de las clases:

-   [Introduction to Statistical Thinking](https://github.com/dccuchile/CC6104/blob/master/slides/1_1_ST-intro.pdf)
-   [Introduction to R](https://github.com/dccuchile/CC6104/blob/master/slides/1_2_ST-R.pdf)
-   [Descriptive Statistics](https://github.com/dccuchile/CC6104/blob/master/slides/1_3_ST-explore.pdf)
-   [Probability](https://github.com/dccuchile/CC6104/blob/master/slides/1_4_ST-prob.pdf)

Videos de las clases:

-   Introduction to Statistical Thinking: [video1](https://youtu.be/X4SqJu6lExM) [video2](https://youtu.be/YbiQU5TTBX4)
-   Introduction to R: [video1](https://youtu.be/MbeLD3hWWVo) [video2](https://youtu.be/9W_eWCy86F4) [video3](https://youtu.be/QvFXSw2-1r4) [video4](https://youtu.be/y4JY7klrbfQ)
-   Descriptive Statistics: [video1](https://youtu.be/kWNskZ8_98o) [video2](https://youtu.be/_FJ8x9M4b1w) [video3](https://youtu.be/m7VBNZ2mYWI) [video4](https://youtu.be/ylGMJ_aSQk0)
-   Probability: [video1](https://youtu.be/R9AVYV73m1M) [video2](https://youtu.be/zubh1jbRiKE) [video3](https://youtu.be/uiwToagp0z4) [video4](https://youtu.be/RlhN3t_VIyw) [video5](https://youtu.be/4kV1dBaeWVc) [video6](https://youtu.be/MGyXc70JdSk)

### **Elaboraci√≥n de c√≥digo**<a name="id4"></a>

En la siguiente secci√≥n deber√° resolver cada uno de los experimentos computacionales a trav√©s de la programaci√≥n en R. Para esto se le aconseja que cree funciones en R, ya que le facilitar√° la ejecuci√≥n de gran parte de lo solicitado.

## Pregunta 1: Visualizaci√≥n de Datos

Para esta pregunta usted deber√° trabajar en base al conjunto de datos `hearth_database.csv`, el cual esta compuesto por las siguientes variables:

-   target: Se√±ala si el paciente tuvo un infarto.
-   sex: Sexo de los sujetos de prueba.
-   fbs: Az√∫car en la sangre con ayunas. Esta variable se√±ala solo si se encuentra \<=120 o \>120.
-   exang: Angina de pecho inducida por el ejercicio.
-   cp: Tipo de dolor de pecho.
-   restecg: Resultados electrocardiogr√°ficos en reposo.
-   slope: Pendiente del segmento ST m√°ximo de ejercicio.
-   ca: N√∫mero de buques principales.
-   thal: Thalassemia.
-   age: Edad en a√±os.
-   trestbps: Presi√≥n arterial en reposo.
-   chol: colesterol s√©rico en mg/dl.
-   thalach: Frecuencia card√≠aca m√°xima alcanzada.
-   oldpeak: Depresi√≥n del ST inducida por el ejercicio en relaci√≥n con el reposo.

En base al dataset propuesto realice un an√°lisis exploratorio de los datos (EDA). Para su an√°lisis enfoquen el desarrollo en las siguientes tareas:

-   [ ] Obtenga la media, mediana, quintiles y valores m√°ximos desde los datos que componen el dataset.
-   [ ] Obtenga la Matriz de correlaci√≥n de Pearson y visualice la relaci√≥n entre las variables num√©ricas.
-   [ ] Visualice los boxplot para las variables num√©ricas.
-   [ ] Visualice a trav√©s de un histograma como distribuyen las variables respecto a los TARGET.

**Respuesta**

```{r eval=FALSE}
data <- read.csv("hearth_database.csv")

summary(data)
```

```{r eval=FALSE}
cor(data[,7:14])
```

```{r eval=FALSE}
boxplot(x=data[,7:14],main="Boxplot data")
```

```{r eval=FALSE}
data <- read.csv("hearth_database.csv")
data$target <- as.numeric(data$target == "YES")

hist(data[,7][data$target == 1],nclass=10, main = "slope")
hist(data[,7][data$target == 0],nclass=10, main = "slope")

hist(data[,8][data$target == 1],nclass=10, main = "ca")
hist(data[,8][data$target == 0],nclass=10, main = "ca")

hist(data[,9][data$target == 1],nclass=10, main = "thal")
hist(data[,9][data$target == 0],nclass=10, main = "thal")

hist(data[,10][data$target == 1],nclass=10, main = "age")
hist(data[,10][data$target == 0],nclass=10, main = "age")

hist(data[,11][data$target == 1],nclass=10, main = "trestbps")
hist(data[,11][data$target == 0],nclass=10, main = "trestbps")

hist(data[,12][data$target == 1],nclass=10, main = "chol")
hist(data[,12][data$target == 0],nclass=10, main = "chol")

hist(data[,13][data$target == 1],nclass=10, main = "thalach")
hist(data[,13][data$target == 0],nclass=10, main = "thalach")

hist(data[,14][data$target == 1],nclass=10, main = "oldpeak")
hist(data[,14][data$target == 0],nclass=10, main = "oldpeak")
```

------------------------------------------------------------------------

## Pregunta 2: Teorema Central del Limite

Pruebe el teorema central del limite aplicando un muestreo de la media en las distribuciones Gamma, Normal y una a su elecci√≥n. Grafique los resultados obtenidos y se√±ale aproximadamente el numero de muestreos necesarios para obtener el resultado esperado, pruebe esto con las siguientes cantidades de muestreo $\{10,100,1000,5000\}$. ¬øEl efecto ocurre con el mismo n√∫mero de muestreo para todas las distribuciones?.

**Respuesta**

```{r eval=FALSE}
# Definici√≥n de variables o estructuras necesarias para el muestreo.
n <- 1000
sigma <- sqrt(5)
mu <-5
pnorm(5.5,mean = 5,sd =sigma/sqrt(n))

# Realizar el muestreo de las distribuciones.
for(i in 1:n) {
  
}

# C√≥digo para gr√°ficos
```

------------------------------------------------------------------------

## Pregunta 3: Ley de los Grandes Numeros.

#### Lanzamiento de monedas

Realice el experimento de lanzar una moneda cargada 1000 veces y observe el comportamiento que tiene la probabilidad de salir cara. Para realizar el experimento considere que la moneda tiene una probabilidad de $5/8$ de salir cara. Grafique el experimento para las secuencias de intentos que van desde 1 a 1000, se√±alando el valor en que converge la probabilidad de salir cara.

**Respuesta**

```{r eval=TRUE}

convergencia <- 1:1000

# Simular lanzamientos
for (lanzamientos in 1:1000) {
  convergencia[lanzamientos] = rbinom(n = 1,size=lanzamientos,p=5/8)/lanzamientos
}

# Gr√°fico de la convergencia
#convergencia

plot(convergencia,type = "l", xlab = "N√∫mero de intentos", ylab = "Probabilidad de salir cara")
abline(h = 5/8, col = "red", lty = 2)
```

#### El problema de Monty Hall

Remont√°ndonos en la televisi√≥n del a√±o 1963, en USA exist√≠a un programa de concursos donde los participantes deb√≠an escoger entre 3 puertas para ganar un premio so√±ado. El problema del concurso era que solo detr√°s de 1 puerta estaba el premio mayor, mientras que detr√°s de las otras dos hab√≠an cabras como "premio".

Una de las particularidades de este concurso, es que cuando el participante escog√≠a una puerta, el animador del show abr√≠a una de las puertas que no fue escogida por el participante (Obviamente la puerta abierta por el animador no conten√≠a el premio). Tras abrir la puerta, el animador consultaba al participante si su elecci√≥n era definitiva, o si deseaba cambiar la puerta escogida por la otra puerta cerrada. Un v√≠deo que puede ayudar a comprender mejor este problema en el siguiente [link](https://www.youtube.com/watch?v=rSa_uiKncEI).

Imagine que usted es participante del concurso y desea calcular la probabilidad de ganar el gran premio **si cambia de puerta** en el momento que el animador se lo ofrece. Utilizando listas/arrays/vectores simule las puertas del concurso, dejando aleatoriamente el premio en alguna posici√≥n del array. Hecho esto, genere un numero de forma aleatoria para escoger una de las puerta (posiciones de la estructura), para luego ver si cambiando de posici√≥n tendr√° mayores posibilidades de ganar el premio. Genere N veces el experimento y grafique cada una de las iteraciones, tal como se hizo en el ejercicio de las monedas.

<p align="center">

<img src="https://brilliant-staff-media.s3-us-west-2.amazonaws.com/tiffany-wang/gWotbuEdYC.png" width="350"/>

</p>

**Respuesta:**

```{r eval=FALSE}
# Creamos una funci√≥n que simule el juego
montyhall <- function(cambiar = TRUE) {
  Puertas <- sample(1:3, 3)   # Generar las puertas con una que tenga el premio (3)
  cat("Puertas:", Puertas, "; ")
  
  posicion <- sample(1:3, 1)  # Elecci√≥n inicial del participante
  cat("Posici√≥n elegida:", posicion, "; ")
  
  # Identificar puertas descartables (que no tienen el premio)
  puertas_descartables <- which(Puertas != 3 & 1:3 != posicion)
  cat("Puertas descartables:", puertas_descartables, "; ")
  
  # Escoger una puerta para descartar
  puerta_descartada <- puertas_descartables[sample(length(puertas_descartables), 1)]
  cat("Puerta descartada:", puerta_descartada, "; ")
  
  # Si el participante decide cambiar su elecci√≥n
  if (cambiar) {
    nuevas_opciones <- setdiff(1:3, c(posicion, puerta_descartada))
    posicion <- nuevas_opciones
  }
  cat("Nueva elecci√≥n:", posicion, "; ")
  
  # Verificar si la elecci√≥n final tiene el premio
  Eleccion <- ifelse(Puertas[posicion] == 3, "Ganaste", "Perdiste")
  cat("Eleccion", Eleccion)
  return(Eleccion) 
}

# Ejemplo de uso:
cat(montyhall(TRUE))


# Funci√≥n que simula N juegos

n_juegos <- function(n = 10 ,cambiar_puerta = TRUE){
  convergencia <- numeric(n)
  
  for (juego in 1:n) {
    cat("Juego",juego , ":")
    resultado <- montyhall(cambiar_puerta)
    
    # Convertir el resultado a num√©rico: 1 para "Ganaste", 0 para "Perdiste"
    convergencia[juego] <- ifelse(resultado == "Ganaste", 1, 0)
  }
  return(convergencia)
}

# Ejecutar la simulaci√≥n de 10 juegos
resultados <- n_juegos(10, TRUE)
cat("Resultados de los juegos:", resultados, "\n")

# Graficar la convergencia
plot(cumsum(resultados) / 1:10, type = "l", xlab = "N√∫mero de juegos", ylab = "Proporci√≥n de √©xitos", main = "Convergencia de Monty Hall")

```

------------------------------------------------------------------------

## Pregunta 4: ¬øIndependencia?

Ustedes disponen de los dados D1 y D2, los cuales no est√°n cargados y son utilizados para comprobar que $\mathbb{P}(AB)=\mathbb{P}(A)\mathbb{P}(B)$ cuando el evento A es independiente del B. Para estudiar la independencia considere que los eventos A y B se definen de la siguiente manera; sea A el evento dado por los valores obtenidos en el lanzamiento del dado D1, este est√° compuesto por $A=\{D1=1,D1=2,D1=6\}$. Por otro lado, el evento B viene dado por los valores obtenidos con el dado D2, el que est√° conformado por $B=\{D2=1,D2=2,D2=3,D2=4\}$. Con esto, tendremos un $\mathbb{P}(A)=1/2$, $\mathbb{P}(ùêµ)=2/3$ y $\mathbb{P}(AB)=1/3$. Compruebe de forma gr√°fica que al realizar 1000 lanzamientos (u otro valor grande que usted desea probar) se visualiza que $\mathbb{P}(AB)=\mathbb{P}(A)\mathbb{P}(B)$.

Hecho lo anterior, compruebe el comportamiento de un segundo grupo de eventos, dados por el lanzamiento de solo el dado D1. Donde, los eventos para D1 quedan definidos como: $A =\{D1=1,D1=2,D1=6\}$ y $B=\{D1=1,D1=2,D1=3\}$. ¬øSe observa independencia en este experimento?.

Se le aconseja que para simular los lanzamientos de dados utilice la funci√≥n `sample()` para generar valores aleatorios entre 1 y 6. Compruebe los n√∫meros generados por la funci√≥n con los casos favorables de cada uno de los eventos a ser estudiados.

**Respuesta:**

```{r eval=FALSE}
library(ggplot2)
# Primer grupo de eventos
N_lan = 1000 # Numero de lanzamientos

L_A = c(1, 2, 6) # Lanzamientos favorables A = c(1, 2, 6)
L_B = c(1, 2, 3, 4) # Lanzamientos favorables B = c(1, 2, 3, 4)
L_AB = c(1, 2) # Lanzamientos favorables AB = c(1, 2)

# Simular lanzamientos
D1 <- sample(1:6, N_lan, replace = TRUE)
D2 <- sample(1:6, N_lan, replace = TRUE)

A <- 0
B <- 0
AB <- 0

P_A_x_P_B <- numeric(N_lan)
P_AB <- numeric(N_lan)

# Conteo de casos
for (i in 1:N_lan) {
  a <- FALSE
  b <- FALSE
  if (D1[i] %in% L_A) {
    A <- A + 1
    a <- TRUE
  }
  if (D2[i] %in% L_B) {
    B <- B + 1
    b <- TRUE
  }
  if (a && b) {
    AB <- AB + 1
  }
  
  # Calcular las probabilidades acumuladas
  P_A_x_P_B[i] <- (A / i) * (B / i)
  P_AB[i] <- AB / i
}

# Gr√°fico del experimento
plot(1:N_lan, P_A_x_P_B, type = "l", col = "blue", ylim = c(0, 1), xlab = "N√∫mero de lanzamientos", ylab = "Probabilidad")
lines(1:N_lan, P_AB, col = "red")
legend("topright", legend = c("P(A)*P(B)", "P(A‚à©B)"), col = c("blue", "red"), lty = 1)
```

# Respuesta 1:

Es claro observar que ambos eventos convergen a valores practicamente iguales a medida que aumentamos el n√∫mero de lanzamientos , Esto confirma que el evento A y B son independientes, Ya que A depende del dado 1 y B depende del dado 2.

```{r eval=FALSE}
# Segundo grupo de eventos
N_lan = 1000 # Numero de lanzamientos
  
L_A = c(1, 2, 6)  # Lanzamientos favorables A = c(1, 2, 6)
L_B = c(1, 2, 3)   # Lanzamientos favorables B = c(1, 2, 3)
L_AB = c(1, 2) # Lanzamientos favorables AB = c(1, 2)

# Simular lanzamientos
D1 <- sample(1:6, N_lan, replace = TRUE)

A <- 0
B <- 0
AB <- 0

P_A_x_P_B <- numeric(N_lan)
P_AB <- numeric(N_lan)

# Conteo de casos
for (i in 1:N_lan) {
  a <- FALSE
  b <- FALSE
  if (D1[i] %in% L_A) {
    A <- A + 1
    a <- TRUE
  }
  if (D1[i] %in% L_B) {  # D1 para B
    B <- B + 1
    b <- TRUE
  }
  if (a && b) {
    AB <- AB + 1
  }
  
  # Calcular las probabilidades acumuladas
  P_A_x_P_B[i] <- (A / i) * (B / i)
  P_AB[i] <- AB / i
}

plot(1:N_lan, P_A_x_P_B, type = "l", col = "blue", ylim = c(0, 1), xlab = "N√∫mero de lanzamientos", ylab = "Probabilidad", main = "Independencia - Un Dado")
lines(1:N_lan, P_AB, col = "red")
legend("topright", legend = c("P(A)*P(B)", "P(A‚à©B)"), col = c("blue", "red"), lty = 1)
```

# Respuesta 2:

Es claro observar que ambos eventos no convergen a valores iguales , esto debido a que el evento A y B son dependientes, Ya que A depende del dado 1 y B tambien depende del dado 1.

------------------------------------------------------------------------

## Pregunta 5: La Ruina del Jugador

Un amigo lud√≥pata suyo le comenta que el truco de jugar en el casino esta en no parar de apostar y apostando lo m√≠nimo posible. Ya que as√≠, tienes mas probabilidades de ganar el gran pozo que acumula el juego. Usted sabiendo la condici√≥n de su amigo, decide no creer en su conjetura y decide probar esto a trav√©s de un experimento.

Para realizar el experimento usted decide asumir las siguientes declaraciones, bajo sus observaciones:

-   La probabilidad de ganar en un juego del casino es $8/19$
-   Sabe que su amigo *solo* posee siempre fondos en el rango de 0 a 200 dolares.
-   Las apuestas como m√≠nimo deben ser igual a 5 dolares.
-   El monto de las apuestas no cambia y son siempre igual a la primera. Por ejemplo, si su amigo apuesta 50 dolares, todos los pr√≥ximos juegos apuesta 50 hasta que se acaba su dinero.
-   Usted pierde cuando se le acaban los fondos.

En el primer experimento deber√° obtener la evoluci√≥n de los fondos hasta que el jugador se queda sin fondos para jugar. Puede ser √∫til seguir la l√≥gica de una moneda cargada para realizar esto. Pruebe esto con una apuesta igual a 5, 25 y 50 graficando los resultados. Comente los resultados obtenidos.

Para la segunda parte de este experimento, con las funciones ya creadas, proyecte 5000 apuestas y obtenga la probabilidad a la que converge el experimento empezando con una apuesta de: 5, 25 y 50. Para este experimento considerar como √©xito (1) cuando su funci√≥n ruina supera los 200 y considere lo contrario cuando su funci√≥n perdida es menor o igual a 0.

**Respuesta**

```{r eval=FALSE}
# Funci√≥n para obtener el desarrollo de las apuestas
ruina <- function(fondos = 100, apuesta = 5){
  vec_fondos <- c(fondos)  # Monto inicial
  prob_ganar <- 8 / 19    # Probabilidad de ganar
  while (0<fondos & fondos<=200) {
    if (runif(1) < prob_ganar) {  # Generar un n√∫mero aleatorio para determinar el resultado del juego
      fondos <- fondos + apuesta  # Gan√≥
    } else {
      fondos <- fondos - apuesta  # Perdi√≥, disminuye los fondos
    }
    vec_fondos <- c(vec_fondos, fondos)  # Guardar los fondos despues de cada iteracion
  }
  return(vec_fondos) #
}

plot(ruina(), type="l", col="blue", xlab="N¬∞ de juegos", ylab="Fondos", main="Evoluci√≥n de los fondos (apuesta = 5)")
plot(ruina(apuesta = 25), type="l", col="blue", xlab="N¬∞ de juegos", ylab="Fondos", main="Evoluci√≥n de los fondos (apuesta = 25)")
plot(ruina(apuesta = 50), type="l", col="blue", xlab="N¬∞ de juegos", ylab="Fondos", main="Evoluci√≥n de los fondos (apuesta = 50)")
```

## Respuesta 5

Con una apuesta de \$5, la evoluci√≥n de los fondos muestra una tendencia a la baja, el jugador juega muchas veces antes de quedarse sin dinero. Es dif√≠cil que el jugador supere los \$120, ya que las ganancias peque√±as no compensan las p√©rdidas acumuladas

Con una apuesta de \$25, el jugador se queda sin fondos en menos tiempo comparado con una apuesta de \$5.

Con una apuesta de \$50, las p√©rdidas se sienten de manera a√∫n m√°s r√°pida, pero las ganancias, cuando ocurren, son mayores, llegando a ganar considerablemente m√°s veces comparado con los otros dos casos.

```{r}
probabilidad_ruina <- function(apuesta = 5, n_simulaciones = 5000){
  exitos <- 0  # Contador de √©xitos
  
  for (i in 1:n_simulaciones) {
    final_fondos <- ruina(apuesta = apuesta)
    if (final_fondos[length(final_fondos)] > 200) {
      exitos <- exitos + 1  # Exito si se superan los 200 d√≥lares
    }
  }
  
  prob_exito <- exitos / n_simulaciones  # Calcular la probabilidad de √©xito
  return(prob_exito)
}

# Calcular la probabilidad de ruina para diferentes tama√±os de apuesta
prob_ruina_5 <- probabilidad_ruina(apuesta = 5)
prob_ruina_25 <- probabilidad_ruina(apuesta = 25)
prob_ruina_50 <- probabilidad_ruina(apuesta = 50)

cat("Probabilidad de ruina con apuesta de 5 d√≥lares:", prob_ruina_5, "\n")
cat("Probabilidad de ruina con apuesta de 25 d√≥lares:", prob_ruina_25, "\n")
cat("Probabilidad de ruina con apuesta de 50 d√≥lares:", prob_ruina_50, "\n")
```

<hr />

<p style="text-align: center;">

A work by <a href="https://github.com/dccuchile/CC6104">CC6104</a>

</p>

<!-- Add icon library -->

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css">

<!-- Add font awesome icons -->

<p style="text-align: center;">

<a href="https://github.com/dccuchile/CC6104"><i class="fab fa-github" style='font-size:30px'></i></a>

</p>

¬†
